(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12499,        336]
NotebookOptionsPosition[     11209,        288]
NotebookOutlinePosition[     11593,        305]
CellTagsIndexPosition[     11550,        302]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"\:8b8a\:683c\:6d3b\:7528\:52d5\:8a5eQ", "[", "w_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"specialverb", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<\:6765\:308b\>\"", ",", "\"\<\:70ba\:308b\>\""}], "}"}]}],
      "}"}], ",", 
    RowBox[{"MemberQ", "[", 
     RowBox[{"specialverb", ",", "w"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6230316346628437`*^9, 3.6230317224688654`*^9}, {
  3.6230317584669247`*^9, 3.6230317595099845`*^9}, {3.623031805954641*^9, 
  3.6230318445548487`*^9}, {3.6230321485332355`*^9, 3.6230321736776733`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\:8b8a\:683c\:6d3b\:7528\:52d5\:8a5eQ", "[", "\"\<\:6765\:308b\>\"",
   "]"}]], "Input",
 CellChangeTimes->{{3.6230322089316897`*^9, 3.623032239412433*^9}, {
  3.6230323541709967`*^9, 3.623032354714028*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6230575137780867`*^9, 3.6232258430836906`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\:4e00\:6bb5\:6d3b\:7528\:52d5\:8a5eQ", "[", "w_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"chs", "=", 
      RowBox[{"Characters", "[", "w", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"\:8b8a\:683c\:6d3b\:7528\:52d5\:8a5eQ", "[", "w", "]"}]}], "&&",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Last", "[", "chs", "]"}], "\[Equal]", "\"\<\:308b\>\""}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6230631682270803`*^9, 3.623063170147427*^9}, {
   3.623063269309518*^9, 3.623063329087109*^9}, 3.623063365183505*^9, {
   3.6230637023475933`*^9, 3.6230637095922213`*^9}, {3.62306374864431*^9, 
   3.6230638774493637`*^9}, {3.6231404309614487`*^9, 3.6231404863996468`*^9}, 
   3.623140517448305*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\:4e00\:6bb5\:6d3b\:7528\:52d5\:8a5eQ", "[", "\"\<\:6765\:308b\>\"",
   "]"}]], "Input",
 CellChangeTimes->{{3.623063351373802*^9, 3.6230633600197077`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.623063374857703*^9, 3.623063715824939*^9, 3.623063815900556*^9, {
   3.623063847058262*^9, 3.6230638857924*^9}, 3.623064258369514*^9, {
   3.623140531407143*^9, 3.623140537707589*^9}, 3.623225843113536*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\:4e94\:6bb5\:52d5\:8a5e", "=", 
  RowBox[{"{", "\"\<\:77e5\:308b\>\"", "}"}]}]], "Input",
 CellChangeTimes->{{3.62314217261329*^9, 3.623142238820573*^9}}],

Cell[BoxData[
 RowBox[{"{", "\<\"\:77e5\:308b\"\>", "}"}]], "Output",
 CellChangeTimes->{3.623142243414263*^9, 3.623225843149795*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\:4e00\:6bb5\:6d3b\:7528\:52d5\:8a5eQ", "[", "\"\<\:77e5\:308b\>\"",
   "]"}]], "Input",
 CellChangeTimes->{3.623142008427528*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.623142010296713*^9, 3.6232258431630783`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"raw", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\:3041\:3042\:3043\:3044\:3045\:3046\:3047\:3048\:3049\:304a\:304b\
\:304c\:304d\:304e\:304f\>\"", ",", "\n", 
     "\"\<\:3050\:3051\:3052\:3053\:3054\:3055\:3056\:3057\:3058\:3059\:305a\
\:305b\:305c\:305d\:305e\:305f\>\"", ",", "\n", 
     "\"\<\:3060\:3061\:3062\:3063\:3064\:3065\:3066\:3067\:3068\:3069\:306a\
\:306b\:306c\:306d\:306e\:306f\>\"", ",", "\n", 
     "\"\<\:3070\:3071\:3072\:3073\:3074\:3075\:3076\:3077\:3078\:3079\:307a\
\:307b\:307c\:307d\:307e\:307f\>\"", ",", "\n", 
     "\"\<\:3080\:3081\:3082\:3083\:3084\:3085\:3086\:3087\:3088\:3089\:308a\
\:308b\:308c\:308d\:308e\:308f\>\"", ",", "\n", 
     "\"\<\:3090\:3091\:3092\:3093\:3094\:3095\:3096\:3099\:309a\:309b\:309c\
\:309d\:309e\:309f\>\""}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.623152020767763*^9, 3.623152026111051*^9}, {
  3.623152119010448*^9, 3.623152217642744*^9}, {3.623178369678009*^9, 
  3.623178374729158*^9}, {3.62317842744936*^9, 3.623178504976956*^9}, {
  3.623178684389069*^9, 3.623178768226392*^9}, {3.62317883521205*^9, 
  3.623178844352373*^9}, {3.6231793796175623`*^9, 3.6231794082350082`*^9}, {
  3.623179591233971*^9, 3.623179604041253*^9}, {3.623225921764367*^9, 
  3.6232259300297623`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"charaters", "=", 
  RowBox[{"Fold", "[", 
   RowBox[{"StringJoin", ",", 
    RowBox[{"First", "@", "raw"}], ",", 
    RowBox[{"Rest", "@", "raw"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.623179609836499*^9, 3.62317963110083*^9}, {
  3.623180155990501*^9, 3.6231802069968443`*^9}, {3.623180599999148*^9, 
  3.623180609327118*^9}}],

Cell[BoxData["\<\"\:3041\:3042\:3043\:3044\:3045\:3046\:3047\:3048\:3049\:304a\
\:304b\:304c\:304d\:304e\:304f\:3050\:3051\:3052\:3053\:3054\:3055\:3056\:3057\
\:3058\:3059\:305a\:305b\:305c\:305d\:305e\:305f\:3060\:3061\:3062\:3063\:3064\
\:3065\:3066\:3067\:3068\:3069\:306a\:306b\:306c\:306d\:306e\:306f\:3070\:3071\
\:3072\:3073\:3074\:3075\:3076\:3077\:3078\:3079\:307a\:307b\:307c\:307d\:307e\
\:307f\:3080\:3081\:3082\:3083\:3084\:3085\:3086\:3087\:3088\:3089\:308a\:308b\
\:308c\:308d\:308e\:308f\:3090\:3091\:3092\:3093\:3094\:3095\:3096\:3099\:309a\
\:309b\:309c\:309d\:309e\:309f\"\>"], "Output",
 CellChangeTimes->{
  3.6231803993989058`*^9, {3.6231806111254263`*^9, 3.623180623137184*^9}, 
   3.6232258432285337`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.623226419517*^9, 3.623226423114325*^9}, 
   3.623227089457781*^9}],

Cell[BoxData[{
 RowBox[{"\:3042", " ", "\:3044", " ", "\:3046", " ", "\:3048", " ", 
  "\:304a"}], "\n", 
 RowBox[{" ", 
  RowBox[{
  "\:304b", " ", "\:304d", " ", "\:304f", " ", "\:3051", " ", 
   "\:3053"}]}], "\n", 
 RowBox[{"\:3055", " ", "\:3057", " ", "\:3059", " ", "\:305b", " ", 
  "\:305d"}], "\n", 
 RowBox[{"\:305f", " ", "\:3061", " ", "\:3064", " ", "\:3066", " ", 
  "\:3068"}], "\n", 
 RowBox[{"\:306a", " ", "\:306b", " ", "\:306c", " ", "\:306d", " ", 
  "\:306e"}], "\n", 
 RowBox[{"\:306f", " ", "\:3072", " ", "\:3075", " ", "\:3078", " ", 
  "\:307b"}], "\n", 
 RowBox[{"\:307e", " ", "\:307f", " ", "\:3080", " ", "\:3081", " ", 
  "\:3082"}], "\n", 
 RowBox[{"\:3084", "  ", "Null", " ", "\:3086", " ", "Null", " ", 
  "\:3088"}], "\n", 
 RowBox[{"\:3089", " ", "\:308a", " ", "\:308b", " ", "\:308c", " ", 
  "\:308d"}], "\n", 
 RowBox[{"\:308f", " ", "\:3090", " ", "Null", " ", "\:3091", " ", 
  "\:3092"}]}], "Input",
 CellChangeTimes->{{3.623226765176523*^9, 3.6232267713314962`*^9}, {
  3.623226925750547*^9, 3.623226930357286*^9}, {3.623227001372573*^9, 
  3.623227118690321*^9}, {3.62322715028441*^9, 3.623227179370647*^9}, {
  3.62322739299934*^9, 3.623227431662067*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.623227170871791*^9, 3.623227198462091*^9}, 
   3.623227741989428*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "flat", "=", 
   "\"\<\:3042 \:3044 \:3046 \:3048 \:304a\n \:304b \:304d \:304f \:3051 \
\:3053\n\:3055 \:3057 \:3059 \:305b \:305d\n\:305f \:3061 \:3064 \:3066 \
\:3068\n\:306a \:306b \:306c \:306d \:306e\n\:306f \:3072 \:3075 \:3078 \
\:307b\n\:307e \:307f \:3080 \:3081 \:3082\n\:3084  Null \:3086 Null \:3088\n\
\:3089 \:308a \:308b \:308c \:308d\n\:308f \:3090 Null \:3091 \:3092\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6232277495634403`*^9, 3.6232278497628593`*^9}, {
  3.623227950180499*^9, 3.623227955068511*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"flat", "'"}], "=", 
  RowBox[{"StringReplace", "[", 
   RowBox[{"flat", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\< \>\"", ".."}], "\[Rule]", "\"\<\>\""}], ",", 
      RowBox[{"\"\<Null\>\"", "\[Rule]", "\"\<#\>\""}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.623227974889085*^9, 3.6232280177184067`*^9}, {
   3.623228110167899*^9, 3.623228113851119*^9}, {3.623228254474312*^9, 
   3.623228313294465*^9}, {3.623228724146183*^9, 3.623228750810417*^9}, {
   3.623228837925131*^9, 3.6232288448058043`*^9}, {3.6232295358752003`*^9, 
   3.6232295476319942`*^9}, 3.623230286361588*^9, {3.623234946571418*^9, 
   3.623234959076473*^9}}],

Cell[BoxData["\<\"\:3042\:3044\:3046\:3048\:304a\\n\:304b\:304d\:304f\:3051\
\:3053\\n\:3055\:3057\:3059\:305b\:305d\\n\:305f\:3061\:3064\:3066\:3068\\n\
\:306a\:306b\:306c\:306d\:306e\\n\:306f\:3072\:3075\:3078\:307b\\n\:307e\:307f\
\:3080\:3081\:3082\\n\:3084#\:3086#\:3088\\n\:3089\:308a\:308b\:308c\:308d\\n\
\:308f\:3090#\:3091\:3092\"\>"], "Output",
 CellChangeTimes->{
  3.6232281149386683`*^9, 3.6232283144776382`*^9, {3.623228741721917*^9, 
   3.623228752090723*^9}, 3.623228846111416*^9, 3.623229357691181*^9, 
   3.623229548728218*^9, 3.623229584976305*^9, 3.623229615941822*^9, 
   3.623230287503767*^9, 3.623231093484375*^9, 3.623231148008791*^9, 
   3.623234960709*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"flat2", "=", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"flat", "'"}], ",", 
      RowBox[{
       RowBox[{"x_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "=!=", "\"\<\\n\>\""}], "&"}], ")"}]}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"\"\<{\>\"", "~~", "x", "~~", "\"\<},\>\""}], ")"}]}]}], 
     "]"}], "//", 
    RowBox[{
     RowBox[{"StringDrop", "[", 
      RowBox[{"#", ",", 
       RowBox[{"-", "1"}]}], "]"}], "&"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6232288770205507`*^9, 3.6232288964064627`*^9}, {
   3.623229187635848*^9, 3.623229272712695*^9}, {3.6232293034755096`*^9, 
   3.6232293058665733`*^9}, 3.623229349017005*^9, 3.623229602306213*^9, {
   3.6232296498537292`*^9, 3.6232296593433037`*^9}, {3.623229739712408*^9, 
   3.623229791337371*^9}, 3.623230214705611*^9, {3.62323117786228*^9, 
   3.623231186029416*^9}, {3.6232324053527527`*^9, 3.623232418433196*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"flatName", "=", 
   RowBox[{"StringInsert", "[", 
    RowBox[{
     RowBox[{"StringInsert", "[", 
      RowBox[{"flat2", ",", "\"\<{\>\"", ",", "1"}], "]"}], ",", "\"\<}\>\"", 
     ",", 
     RowBox[{"-", "1"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6232299043618383`*^9, 3.6232299945337477`*^9}, {
  3.62323006954847*^9, 3.623230090261561*^9}, {3.623230125654845*^9, 
  3.623230133372285*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"flatName", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"flatName", ",", 
     RowBox[{"\"\<\\n\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6232327491729918`*^9, 3.623232766071375*^9}, {
  3.623232884896317*^9, 3.623232934641741*^9}}]
},
WindowSize->{1220, 720},
WindowMargins->{{Automatic, 43}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 626, 14, 49, "Input"],
Cell[CellGroupData[{
Cell[1209, 38, 231, 4, 49, "Input"],
Cell[1443, 44, 99, 1, 43, "Output"]
}, Open  ]],
Cell[1557, 48, 874, 20, 133, "Input"],
Cell[CellGroupData[{
Cell[2456, 72, 180, 3, 49, "Input"],
Cell[2639, 77, 263, 4, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2939, 86, 179, 3, 49, "Input"],
Cell[3121, 91, 133, 2, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3291, 98, 154, 3, 49, "Input"],
Cell[3448, 103, 97, 1, 43, "Output"]
}, Open  ]],
Cell[3560, 107, 1291, 23, 192, "Input"],
Cell[CellGroupData[{
Cell[4876, 134, 357, 8, 43, "Input"],
Cell[5236, 144, 730, 10, 74, "Output"]
}, Open  ]],
Cell[5981, 157, 115, 2, 43, "Input"],
Cell[6099, 161, 1204, 26, 279, "Input"],
Cell[7306, 189, 118, 2, 43, "Input"],
Cell[7427, 193, 568, 11, 279, "Input"],
Cell[CellGroupData[{
Cell[8020, 208, 708, 16, 43, "Input"],
Cell[8731, 226, 683, 10, 278, "Output"]
}, Open  ]],
Cell[9429, 239, 998, 24, 44, "Input"],
Cell[10430, 265, 449, 11, 43, "Input"],
Cell[10882, 278, 323, 8, 43, "Input"]
}
]
*)

(* End of internal cache information *)
